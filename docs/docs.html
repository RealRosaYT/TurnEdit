<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Documantation - TurnEdit - an simplified text editor for Windows</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
	<style>
		@media screen and (max-width: 800px) {
			main {
				flex-direction: column!important;
				margin: 0;
			}
			.content {
				position: relative;
				display: block;
				max-width: 100vw;
				margin: 0!important;
				box-sizing: border-box;
			}
			.content * img {
				margin: 0;
			}
		}
		* pre {
			position: relative;
			display: block;
			overflow: scroll;
		}
		* code {
			position: relative;
			display: block;
			overflow: scroll;
		}
	</style>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
  <div class="container">
    <a class="navbar-brand" href="index.html">TurnEdit</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link" aria-current="page" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="docs.html">Docs</a>
        </li>
		<li class="nav-item">
			<a class="nav-link" href="download.html">Download</a>
		</li>
    </div>
  </div>
</nav>
	<main style="position: relative;display: flex; width: fit-content; margin-left: 30px; margin-top: 40px;">
		<div id="sidebar" class="flex-column" style="position: relative;display: flex;width: fit-content;">
			<ul class="nav flex-column" id="docs-nav-list">
			</ul>
		</div>
		<div class="content" style="position: relative;display: block; margin-left: 40px;">
		</div>
	</main>
	  <footer class="py-3 my-4">
    <ul class="nav justify-content-center border-bottom pb-3 mb-3">
		<li class="nav-item">
          <a class="nav-link active" aria-current="page" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="docs.html">Docs</a>
        </li>
		<li class="nav-item">
			<a class="nav-link" href="download.html">Download</a>
		</li>
    </ul>
    <p class="text-center text-body-secondary">&copy; 2025 youmu1948, All rights reserved.</p>
  </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
	<script>
		const owner = "suzuki3932";
		const repo = "TurnEdit";
		const PagesPaths = [
		"Home.md",
		"How-to-install-TurnEdit.md",
		"Compiling-source-code.md"
		];
		const GithubWikiBaseURL = `https://raw.githubusercontent.com/wiki/${owner}/${repo}/`;
		
		async function GetWikiContent(path) {
			try {
				const url = GithubWikiBaseURL + path;
				
				const response = await fetch(url);
				if (!response.ok) {
					if (response.status === 404) {
						console.error(`wiki page not found: ${path}`);
						return null;
					}
					throw new Error(`Github API request failed: ${response.status} ${response.statusText}`);
				}
				const data = await response.text();
				return data;
			} catch (error) {
				console.error("Failed to get documentation from Github");
				return null;
			}
		}
		
		function extractTitleFromMarkDown(markdowncontent) {
			if (!markdowncontent) return null;
			
			const tokens = marked.lexer(markdowncontent);
			
			const titleToken = tokens.find(token => token.type === 'heading' && (token.depth === 1 || token.depth === 2));
			if (titleToken) {
				return titleToken.text;
			}
			return null;
		}
		async function InnerWikiHTML(wiki, dom) {
			const markdownContent = await GetWikiContent(wiki);
			
			if (markdownContent) {
				dom.innerHTML = marked.parse(markdownContent);
			} else {
				dom.innerHTML = '<p class="alert-danger">Failed to load Wiki page.</p>';
				console.error("Failed to inner wiki HTML.");
			}
		}
		
			
		        function extractTitleFromMarkDown(markdowncontent) {
            if (!markdowncontent) return null;
            
            const tokens = marked.lexer(markdowncontent);
            const titleToken = tokens.find(token => token.type === 'heading' && (token.depth === 1 || token.depth === 2));
            if (titleToken) {
                return titleToken.text;
            }

            // タイトルが見つからない場合のフォールバック（最初の非空行を試す）
            const firstLine = markdowncontent.split('\n').find(line => line.trim().length > 0);
            if (firstLine) {
                return firstLine.trim();
            }
            return null;
        }

		        async function RenderWikiContentToDOM(pagePath, targetDomElement) {
            targetDomElement.innerHTML = '<p class="text-muted">Loading content...</p>'; // ローディング表示
            const markdownContent = await GetWikiContent(pagePath);
            
            if (markdownContent) {
                targetDomElement.innerHTML = marked.parse(markdownContent);
            } else {
                targetDomElement.innerHTML = '<p class="text-danger">Failed to load Wiki page content.</p>';
                console.error("Failed to render wiki HTML for path:", pagePath);
            }
        }
		
		        async function populateSidebar() {
            const navList = document.getElementById('docs-nav-list');
            const wikiPageContentDiv = document.querySelector("main .content");
            
            // ローディング表示をクリア
            navList.innerHTML = ''; 
        
            let firstPageLoaded = false;

            for (const pagePath of PagesPaths) {
                const markdownContent = await GetWikiContent(pagePath);
                
                if (markdownContent) {
                    let title = extractTitleFromMarkDown(markdownContent);
                    
                    if (!title) {
                        // ファイル名から推測 (例: "How-to-install-TurnEdit.md" -> "How to install TurnEdit")
                        title = pagePath.replace(/\.md$/i, '').replace(/-/g, ' ');
                        console.warn(`No explicit title found for ${pagePath}. Using filename as title: "${title}"`);
                    }
                    
                    const listItem = document.createElement('li');
                    listItem.className = 'nav-item';
                    
                    const link = document.createElement('a');
                    link.className = 'nav-link';
                    link.href = `#${encodeURIComponent(title.toLowerCase().replace(/\s+/g, '-'))}`; 
                    link.textContent = title;
                    
                    // クリックイベントでコンテンツを表示
                    link.addEventListener('click', async (e) => {
                        e.preventDefault();
                        // アクティブなリンクを切り替え
                        navList.querySelectorAll('.nav-link').forEach(navLink => navLink.classList.remove('active'));
                        link.classList.add('active');
                        await RenderWikiContentToDOM(pagePath, wikiPageContentDiv);
                    });
        
                    listItem.appendChild(link);
                    navList.appendChild(listItem);

                    // 最初のページを自動的に表示
                    if (!firstPageLoaded) {
                        link.classList.add('active'); // 最初のリンクをアクティブにする
                        await RenderWikiContentToDOM(pagePath, wikiPageContentDiv);
                        firstPageLoaded = true;
                    }
                }
            }

            // もしページのロードに失敗し、何も表示されない場合のメッセージ
            if (!firstPageLoaded && PagesPaths.length > 0) {
                 wikiPageContentDiv.innerHTML = '<p class="text-danger">Failed to load any Wiki pages. Please check console for errors (e.g., CORS).</p>';
            } else if (PagesPaths.length === 0) {
                navList.innerHTML = '<li class="nav-item"><span class="nav-link text-muted">No Wiki pages defined in PagesPaths.</span></li>';
                wikiPageContentDiv.innerHTML = '<p class="text-muted">No Wiki pages to display.</p>';
            }
        }
        
        // DOMが完全に読み込まれてからサイドバーを構築
        document.addEventListener('DOMContentLoaded', populateSidebar);
			window.onload = function() {
				InnerWikiHTML(PagesPaths[0], document.querySelector("main .content"));
			}
		// document.addEventListener('DOMContentLoaded', poplateSidebar);
		function ResponsiveDocs() {
			const alldocscontent = document.querySelectorAll(".content *");
			alldocscontent.forEach(docscontent => {
			docscontent.style.maxWidth = '100%';
			});
		}
		const AllNavigation = document.querySelectorAll("#docs-nav-list * .nav-link");
		AllNavigation.forEach(Navigation => {
			Navigation.addEventListener('click', ResponsiveDocs);
		});
	</script>
	<script src="responsive-images.js"></script>
	<script src="current-version.js"></script>
  </body>
</html>